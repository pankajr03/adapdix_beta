var sortable_terms_table=jQuery(".wp-list-table tbody"),taxonomy=jQuery('form input[name="taxonomy"]').val();function term_order_update_callback(response){if("children"!==response){var changes=jQuery.parseJSON(response),new_pos=changes.new_pos;for(var key in new_pos)if("next"!==key){var inline_key=document.getElementById("inline_"+key);if(null!==inline_key&&new_pos.hasOwnProperty(key)){var dom_order=inline_key.querySelector(".order");if(void 0!==new_pos[key].order){null!==dom_order&&(dom_order.innerHTML=new_pos[key].order);var dom_term_parent=inline_key.querySelector(".parent");null!==dom_term_parent&&(dom_term_parent.innerHTML=new_pos[key].parent);var term_title=null,dom_term_title=inline_key.querySelector(".row-title");null!==dom_term_title&&(term_title=dom_term_title.innerHTML);for(var dashes=0;dashes<new_pos[key].depth;)dashes++;var dom_row_title=inline_key.parentNode.querySelector(".row-title")}else null!==dom_order&&(dom_order.innerHTML=new_pos[key])}}changes.next?jQuery.post(ajaxurl,{action:"reordering_terms",id:changes.next.id,previd:changes.next.previd,nextid:changes.next.nextid,start:changes.next.start,excluded:changes.next.excluded,tax:taxonomy},term_order_update_callback):(setTimeout(function(){jQuery(".to-row-updating").removeClass("to-row-updating")},500),sortable_terms_table.removeClass("to-updating").sortable("enable"))}else window.location.reload()}sortable_terms_table.sortable({items:"> tr:not(.no-items)",cursor:"move",axis:"y",cancel:"  .inline-edit-row",distance:2,opacity:.9,tolerance:"pointer",scroll:!0,start:function(e,ui){"undefined"!=typeof inlineEditTax&&inlineEditTax.revert(),ui.placeholder.height(ui.item.height()),ui.item.parent().parent().addClass("dragging")},helper:function(e,ui){return ui.children().each(function(){jQuery(this).width(jQuery(this).width())}),ui},stop:function(e,ui){ui.item.children(".row-actions").show(),ui.item.parent().parent().removeClass("dragging")},update:function(e,ui){sortable_terms_table.sortable("disable").addClass("to-updating"),ui.item.addClass("to-row-updating");var strlen=4,termid=ui.item[0].id.substr(4),prevtermid=!1,prevterm=ui.item.prev();prevterm.length>0&&(prevtermid=prevterm.attr("id").substr(4));var nexttermid=!1,nextterm=ui.item.next();nextterm.length>0&&(nexttermid=nextterm.attr("id").substr(4)),jQuery.post(ajaxurl,{action:"reordering_terms",id:termid,previd:prevtermid,nextid:nexttermid,tax:taxonomy},term_order_update_callback)}});